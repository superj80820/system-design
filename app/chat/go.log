{"level":"error","ts":1702498610.252498,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:526\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:211\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:220\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:531\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:211\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:220\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:212\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:220\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702503996.162653,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:525\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:530\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702503999.0812218,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:525\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:530\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702504309.093777,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:525\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:530\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702504310.668096,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:525\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:530\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702504505.761036,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:525\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:530\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702504507.0825799,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:525\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:530\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702505578.096708,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:526\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:531\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702505627.373482,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:526\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:531\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702506025.3511522,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:526\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:531\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702506053.547743,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:526\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:531\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
{"level":"error","ts":1702506084.264058,"msg":"context canceled\nwrite messages to kafka failed\ngithub.com/superj80820/system-design/kit/mq.(*MQTopic).Produce\n\t/Users/yorklin/git/github/superj80820/system-design/kit/mq/kafka.go:172\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:526\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nproduce user online status failed\ngithub.com/superj80820/system-design/chat/repository.(*ChatRepo).SendUserOnlineStatusMessage\n\t/Users/yorklin/git/github/superj80820/system-design/chat/repository/chat.go:531\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:193\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598\nsend user online status message\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat.func5\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:194\ngithub.com/superj80820/system-design/chat/usecase.(*ChatUseCase).Chat\n\t/Users/yorklin/git/github/superj80820/system-design/chat/usecase/chat.go:202\ngithub.com/superj80820/system-design/chat/delivery/http/websocket.MakeChatEndpoint.func1\n\t/Users/yorklin/git/github/superj80820/system-design/chat/delivery/http/websocket/chat.go:14\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateAuth[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/auth.go:22\ngithub.com/superj80820/system-design/kit/http/websocket/middleware.CreateRateLimit[...].func1.1\n\t/Users/yorklin/git/github/superj80820/system-design/kit/http/websocket/middleware/rate-limit.go:33\ngithub.com/superj80820/system-design/kit/core/transport/http/websocket.(*Server[...]).ServeHTTP.func6\n\t/Users/yorklin/git/github/superj80820/system-design/kit/core/transport/http/websocket/server.go:172\ngithub.com/oklog/run.(*Group).Run.func1\n\t/Users/yorklin/go/pkg/mod/github.com/oklog/run@v1.1.0/group.go:38\nruntime.goexit\n\t/usr/local/Cellar/go/1.20.1/libexec/src/runtime/asm_amd64.s:1598","trace-id":"00000000000000000000000000000000"}
